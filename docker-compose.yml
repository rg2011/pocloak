services:
  pocloak:
    build:
      context: .
      dockerfile: Dockerfile
    image: pocloak:latest
    container_name: pocloak
    user: "1000:1000"
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      - PORT=${PORT:-3000}
      - NODE_ENV=production
      - SESSION_SECRET=${SESSION_SECRET:-dev-session-secret-change-me}
      - OIDC_DISCOVERY_URL=${OIDC_DISCOVERY_URL}
      - OIDC_CLIENT_ID=${OIDC_CLIENT_ID}
      - OIDC_CLIENT_SECRET=${OIDC_CLIENT_SECRET}
      - OIDC_USE_PKCE=${OIDC_USE_PKCE:-true}
      - OIDC_PKCE_METHOD=${OIDC_PKCE_METHOD:-S256}
      - OIDC_SCOPE=${OIDC_SCOPE:-openid profile email offline_access}
      - OIDC_UMA_AUDIENCE=${OIDC_UMA_AUDIENCE}
      - APP_DOMAIN=${APP_DOMAIN:-http://localhost:3000}
